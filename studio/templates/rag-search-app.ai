use model "retriever" provided by "openai"

ai "rewrite_query":
  when called:
    use model "retriever"
    input comes from user_input
    describe task as "Rewrite the query to be concise and retrieval-friendly."

ai "fetch_context":
  when called:
    use model "retriever"
    input comes from user_input
    describe task as "Identify relevant snippets for the rewritten query."

ai "compose_answer":
  when called:
    use model "retriever"
    input comes from user_input
    describe task as "Compose a short answer based on retrieved snippets."

flow "rag_query_flow":
  description "Rewrite the query, retrieve context, and compose an answer."
  this flow will:
    first step "rewrite":
      do ai "rewrite_query"
    then step "retrieve":
      do ai "fetch_context"
    finally step "compose":
      do ai "compose_answer"

app "rag_search_app":
  starts at page "search"
  description "RAG pipeline answering questions over a small note."

page "search":
  found at route "/rag"
  titled "RAG Knowledge Search"
  section "query":
    show text:
      "Ask questions against rag_query_flow to rewrite and answer."
