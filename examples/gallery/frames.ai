frame is "sales_data":
  from file "sales.csv"
  has headers
  select region, revenue, country

flow is "be_revenue":
  step is "filter":
    let be_sales be sales_data:
      keep rows where row.country is "BE"

    let total be 0
    repeat for each row in be_sales:
      set total be total + row.revenue

    log info "Total BE revenue" with { total: total }

    repeat for each row in be_sales:
      log info "Row" with { region: row.region, revenue: row.revenue }
