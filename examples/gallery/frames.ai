frame is "sales_data":
  file is "sales.csv"
  has headers
  fields:
    region:
      type is "string"
    revenue:
      type is "number"
    country:
      type is "string"

flow is "be_revenue":
  step is "filter":
    let be_sales be sales_data:
      keep rows where row.country is "BE"

    let total be 0
    repeat for each row in be_sales:
      set total be total + row.revenue

    log info "Total BE revenue"

    repeat for each row in be_sales:
      log info "Row for " + row.region
