frame is "sales_data":
  source:
    from file "sales.csv"
    has headers
  select:
    columns are ["region", "revenue", "country"]

flow is "be_revenue":
  step is "filter":
    let be_sales be sales_data:
      keep rows where row.country is "BE"

    let total be 0
    repeat for each row in be_sales:
      set total be total + row.revenue

    log info "Total BE revenue"

    repeat for each row in be_sales:
      log info "Row for " + row.region
